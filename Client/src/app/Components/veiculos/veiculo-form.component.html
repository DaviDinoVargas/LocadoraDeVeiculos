<div class="container mt-3">
  <h4 *ngIf="!editMode">Novo Veículo</h4>
  <h4 *ngIf="editMode">Editar Veículo</h4>

  <form [formGroup]="form" (ngSubmit)="salvar()">
    <!-- Placa -->
    <div class="mb-3">
      <label class="form-label">Placa</label>
      <input class="form-control" formControlName="placa" placeholder="AAA-0000 ou AAA-0A00"/>
      <div *ngIf="form.controls['placa'].invalid && form.controls['placa'].touched"
           class="text-danger small">
        Placa inválida. Use o formato AAA-0000 ou AAA-0A00.
      </div>
    </div>

    <!-- Marca -->
    <div class="mb-3">
      <label class="form-label">Marca</label>
      <input class="form-control" formControlName="marca"/>
      <div *ngIf="form.controls['marca'].invalid && form.controls['marca'].touched"
           class="text-danger small">
        Marca é obrigatória.
      </div>
    </div>

    <!-- Modelo -->
    <div class="mb-3">
      <label class="form-label">Modelo</label>
      <input class="form-control" formControlName="modelo"/>
      <div *ngIf="form.controls['modelo'].invalid && form.controls['modelo'].touched"
           class="text-danger small">
        Modelo é obrigatório.
      </div>
    </div>

    <!-- Cor -->
    <div class="mb-3">
      <label class="form-label">Cor</label>
      <input class="form-control" formControlName="cor"/>
      <div *ngIf="form.controls['cor'].invalid && form.controls['cor'].touched"
           class="text-danger small">
        Cor é obrigatória.
      </div>
    </div>

    <!-- Ano -->
    <div class="mb-3">
      <label class="form-label">Ano</label>
      <input type="number"
             min="1900"
             [max]="anoAtual + 1"
             class="form-control"
             formControlName="ano"/>
      <div *ngIf="form.controls['ano'].invalid && form.controls['ano'].touched"
           class="text-danger small">
        Ano deve estar entre 1900 e {{ anoAtual + 1 }}.
      </div>
    </div>

    <!-- Tipo Combustível -->
    <div class="mb-3">
      <label class="form-label">Tipo de Combustível</label>
      <select class="form-select" formControlName="tipoCombustivel">
        <option value="">Selecione o tipo de combustível</option>
        <option value="Gasolina">Gasolina</option>
        <option value="Álcool">Álcool</option>
        <option value="Diesel">Diesel</option>
        <option value="Flex">Flex</option>
        <option value="Elétrico">Elétrico</option>
        <option value="Híbrido">Híbrido</option>
      </select>
      <div *ngIf="form.controls['tipoCombustivel'].invalid && form.controls['tipoCombustivel'].touched"
           class="text-danger small">
        Tipo de combustível é obrigatório.
      </div>
    </div>

    <!-- Capacidade Tanque -->
    <div class="mb-3">
      <label class="form-label">Capacidade do Tanque (Litros)</label>
      <input type="number"
             step="0.1"
             min="0"
             class="form-control"
             formControlName="capacidadeTanque"/>
      <div *ngIf="form.controls['capacidadeTanque'].invalid && form.controls['capacidadeTanque'].touched"
           class="text-danger small">
        Capacidade do tanque deve ser maior que 0.
      </div>
    </div>

    <!-- Grupo de Automóvel -->
    <div class="mb-3">
      <label class="form-label">Grupo de Automóvel</label>
      <select class="form-select" formControlName="grupoAutomovelId">
        <option value="">Selecione um grupo</option>
        <option *ngFor="let grupo of grupos" [value]="grupo.id">{{ grupo.nome }}</option>
      </select>
      <div *ngIf="form.controls['grupoAutomovelId'].invalid && form.controls['grupoAutomovelId'].touched"
           class="text-danger small">
        Grupo de automóvel é obrigatório.
      </div>
    </div>

    <!-- Foto -->
    <div class="mb-3">
      <label class="form-label">Foto (URL)</label>
      <input type="text" class="form-control" formControlName="foto" placeholder="URL da imagem"/>
    </div>

    <!-- Botões -->
    <div class="d-flex gap-2">
      <button class="btn btn-primary"
              type="submit"
              [disabled]="loading">
        <span *ngIf="loading" class="spinner-border spinner-border-sm me-1"></span>
        {{ editMode ? 'Salvar' : 'Criar' }}
      </button>
      <button class="btn btn-secondary"
              type="button"
              (click)="cancelar()"
              [disabled]="loading">
        Cancelar
      </button>
    </div>

    <!-- Erros do servidor -->
    <div *ngIf="serverErrors.length > 0" class="alert alert-danger mt-3">
      <ul class="mb-0">
        <li *ngFor="let error of serverErrors">{{ error }}</li>
      </ul>
    </div>
  </form>
</div>
